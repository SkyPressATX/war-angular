angular.module("warApiClient",[]).provider("$warClientConfig",function(){var e={};this.configure=function(t){e=t},this.$get=["$warCall",function(t){return{init:function(){t._configure(e)}}}]}).service("$warCall",["$http",function(e){var t=this;this.apiCall=function(n,i,s,a){var r={method:n,url:"/"+t._config.api_prefix+i};return t._config.nonce&&(r.headers={"X-WP-Nonce":t._config.nonce}),a&&(r.url+=a),s&&_.isObject(s)&&"GET"===n&&(r.params=s),s&&_.isObject(s)&&"GET"!==n&&(r.data=s),e(r).then(function(e){return e.data}).catch(function(e){return{error:e.statusText,data:e.data}})},this._config={api_prefix:"wp-json",nonce:!1},this._configure=function(e){t._config=_.merge(t._config,e)}}]).service("$warClient",["$warCall",function(e){this.stashRoutes,this.siteDetails={},this.namespaces,this.routes={},this.discover=function(){var t=this;return!_.isEmpty(t.routes)||(!_.isEmpty(t.namespaces)||e.apiCall("GET","/").then(function(e){return e.routes&&(t.stashRoutes=e.routes),e.namespaces&&(t.namespaces=e.namespaces),e.name&&(t.siteDetails.name=e.name),e.description&&(t.siteDetails.description=e.description),!0}).catch(function(e){return console.log(e),{error:e}}))},this.bindRoutes=function(t){var n=this;return t||(t=""),_.assign(n.routes,_.transform(n.stashRoutes,function(n,i,s){if(i.namespace==t&&i.namespace!==_.trimStart(s,"/")){var a=_.replace(s,/\(\?P.+\)/,""),r=_.camelCase(_.replace(_.trimStart(a,"/"),i.namespace+"/",""));n[i.namespace]||(n[i.namespace]={}),_.isEmpty(n[i.namespace][r])&&(n[i.namespace][r]={}),_.each(i.methods,function(t){_.isEmpty(n[i.namespace][r][t])&&(n[i.namespace][r][_.toLower(t)]=_.bind(e.apiCall,n[i.namespace][r],t,a))})}},{})),n.routes},this.name=function(e){if(!_.isString(e))throw new Error("Namespace needs to be a string");if(!_.indexOf(this.namespaces,e)>0)throw new Error(e+" Namespace not found");return _.isEmpty(this.routes[e])&&this.bindRoutes(e),this.routes[e]},this.list=function(e){if(!_.indexOf(this.namespaces,e)>0)throw new Error(e+" Namespace not found");return _.isString(e)&&e?this.routes[e]:this.routes},this.site=function(){return this.siteDetails}}]).run(["$warClientConfig",function(e){e.init()}]);